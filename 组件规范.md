# 组件规范

[关联链接](http://gitlab.yeahka.com/App/iOS/YKComponents/Documents/ducuments-for-developing)

## 背景

本公司组件化工作进行了想当长的一段时间，积累了丰富的组件。然而缺失统一的组件规范，导致每个组件的写法各有差异。因而制定本规范，用以统一组件结构，提升组件的使用体验。

## 代码规范

- 组件名统一以Component结尾；
- 组件名称必须以YK开头； 
- 组件对外的文件必须以YK开头，可能是自定义类文件、类扩展文件;
- 组件私有文件，不得以YK开头，以达到私有文件和对外文件区分的目的;
- 对外接口使用yk开头，用以统一接口的起始字符，且可以区分系统api;
- 对外文件中不要包含组件私有类、私有类扩展；
- 同一个文件内，严禁包含多个复杂类；

oc:

- 组件必须包含同名文件，作为组件的对外入口文件；
- 入口文件必须引用组件中其他所有的对外文件，以便于用户快速引用组件；
- 组件弃用pch文件；

swift:

- 对外文件必须以YK开始；
- 类扩展文件必须以Extension结尾；
- 对外接口必须以yk开始；
- 组件内部接口【internal / private】 务必避开以yk开始；
- 对外文件中避免包含大量内部接口，除非无法避免；
- 对外类的公开属性、方法要集中分布，严禁和私有方法穿插分布。

## 组件结构规范

- 组件必须包含 Public 文件夹，用以存放所有的对外文件;
- 对内文件只能存放在 Private 文件夹内;
- 组件内部私有图片资源，必须以bundle形式包含;
- 组件内部字体，xib,json等文件，必须以bundle形式包含;

## 组件设计规范

- 功能单一，不要存在多功能工具类；
- 适配当下，不要提供过多用户现在用不到的api, 同一功能的api尽量减少接口的数量；
- 保持简单，不要使用不必要的高级用法，代码要做到简单易读易维护，切忌过度设计；
- 不要重复，组件中如果存在重复代码，或者存在多个组件普遍使用的代码段，应当把重复代码抽离，放在工具组件中。

## 组件注释规范

- 组件对外接口/类/扩展，必须提供接口注释，且可以导出接口文档；
- 组件弃用对外接口，必须声明弃用版本；
- 类必须提供类注释，包含类说明；

## 组件说明文档

- 在做到组件注释规范的基础上，完全可以实现组件说明的脚本化；
- 组件交付之前，必须借助工具，输出html格式的组件说明文档；
- 组件README必须填写齐全。

### README 内容

- 组件简介： 组件名称，组件用途，组件使用方法，组件历史版本记录。


### 文档工具

按照iOS标准注释的代码文件，可以通过工具输出html，docset

- jazzy
    
    一款ruby语言的oc/swift注释转换为接口文档的工具。[[参看]](https://github.com/realm/jazzy)
  
  - 安装指令
    ```shell
    gem install jazzy --verbose
    ```
    
  - 缺点：
 
    - 不能同时解析 oc/swift 混编项目，需要分步解析
    
- sourcekitten

    基于 Apple 的 SourceKit 封装的命令行工具，SourceKitten 链接并与 sourcekitd.framework 通信以解析 Swift AST 树，最终提取 Swift 或 ObjC 文件的类结构和方法等。[[参看]](https://github.com/jpsim/SourceKitten)

    - 安装指令
    ```shell
    brew install sourcekitten --verbose
    ```
  
    - 缺点： 

      - 不能同时解析 oc/swift 混编项目，需要分步解析
      - 使用方式复杂
  
- appledocs

  一个命令行工具，它可以帮助 Objective-C 开发者从特殊格式的源代码注释中生成类似 Apple 的源代码文档。它的设计目的是在输入时尽可能采 HTML 格式文档，以及完全索引和可浏览的 Xcode 文档集。

  - 安装方式

    - 拉取源码
    > ```shell
    > git clone git://github.com/tomaz/appledoc.git
    > ```
    
    - 安装
    > ```shell
    > sudo sh install-appledoc.sh
    >```
  
  - 缺点
  
    - 不能解析swift文件
  
## 组件模板

按照此规范，如果手动创建组件，不容易将规范落地。存在以下缺点：

- 操作繁琐，需要手动更podspec配置文件；
- 实施繁琐，靠着人工记忆、翻看规范资料，容易与规范偏差；

因此设计一套模板，开发一个cocoapods插件，用于按照创建符合规范的组件，使用者仅需要一句代码设计规范和注释规范开发组件。

标准组件结构如下：

***<center>组件标注结构</center>***

![](./StandardSourcePng/01.png)